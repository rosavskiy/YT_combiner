# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç Telegram –±–æ—Ç–∞

## ‚ö° –£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –±–æ—Ç –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏?

**–û—Ç–ª–∏—á–Ω–æ!** –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç –∂–µ —Å–∞–º—ã–π –±–æ—Ç.

üëâ **–°–º. –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é:** [`TELEGRAM_EXISTING_BOT.md`](./TELEGRAM_EXISTING_BOT.md)

---

## –ó–∞ 5 –º–∏–Ω—É—Ç –¥–æ –ø–æ–ª–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### 1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ (2 –º–∏–Ω—É—Ç—ã)

1. –û—Ç–∫—Ä–æ–π—Ç–µ [@BotFather](https://t.me/BotFather) –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ: `/newbot`
3. –í–≤–µ–¥–∏—Ç–µ –∏–º—è: `YT Zavod Manager`
4. –í–≤–µ–¥–∏—Ç–µ username: `yt_zavod_bot` (–∏–ª–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π, –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–∏–π—Å—è –Ω–∞ `bot`)
5. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω** (–≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ `123456789:ABCdef...`)

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã (1 –º–∏–Ω—É—Ç–∞)

–û—Ç–ø—Ä–∞–≤—å—Ç–µ BotFather –∫–æ–º–∞–Ω–¥—É `/setcommands` –∏ –≤—Å—Ç–∞–≤—å—Ç–µ:

```
start - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
help - –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
add_channel - –î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–∞–ª –≤ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ
list_channels - –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ –∫–∞–Ω–∞–ª—ã
remove_channel - –£–¥–∞–ª–∏—Ç—å –∫–∞–Ω–∞–ª –∏–∑ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
```

### 3. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ .env (1 –º–∏–Ω—É—Ç–∞)

–û—Ç–∫—Ä–æ–π—Ç–µ `backend/.env` –∏ –¥–æ–±–∞–≤—å—Ç–µ:

```env
# –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à —Ç–æ–∫–µ–Ω –æ—Ç BotFather
TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz1234567890

# –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω
TELEGRAM_WEBHOOK_URL=https://your-domain.com/api/telegram/webhook

# Username –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ (–±–µ–∑ @)
TELEGRAM_BOT_USERNAME=yt_zavod_bot
```

**–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
```env
TELEGRAM_WEBHOOK_URL=https://your-ngrok-url.ngrok.io/api/telegram/webhook
```

### 4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ webhook (1 –º–∏–Ω—É—Ç–∞)

**–í–∞—Ä–∏–∞–Ω—Ç A - –ß–µ—Ä–µ–∑ –Ω–∞—à API:**
```bash
curl -X POST http://localhost:3000/api/telegram/set-webhook
```

**–í–∞—Ä–∏–∞–Ω—Ç B - –ù–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ Telegram API:**
```bash
curl -X POST "https://api.telegram.org/bot<–í–ê–®_–¢–û–ö–ï–ù>/setWebhook" \
  -H "Content-Type: application/json" \
  -d '{"url": "https://your-domain.com/api/telegram/webhook"}'
```

### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å

```bash
curl http://localhost:3000/api/telegram/webhook-info
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å:
```json
{
  "success": true,
  "data": {
    "url": "https://your-domain.com/api/telegram/webhook",
    "has_custom_certificate": false,
    "pending_update_count": 0
  }
}
```

### 6. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ! ‚úÖ

1. –ù–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞: `@yt_zavod_bot`
2. –ù–∞–∂–º–∏—Ç–µ START
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ: `/add_channel https://www.youtube.com/@channelname`

## –í–∞–∂–Ω–æ! ‚ö†Ô∏è

–ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–æ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å **–¥–æ–ª–∂–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å–∞–π—Ç–µ** —á–µ—Ä–µ–∑ Telegram Login Widget!

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à —Å–∞–π—Ç
2. –ù–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram"
3. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å
4. –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ—Ç–∞

## –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω—É–∂–µ–Ω HTTPS. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ngrok:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ngrok
npm install -g ngrok

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç—É–Ω–Ω–µ–ª—å
ngrok http 3000

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ https URL (–Ω–∞–ø—Ä–∏–º–µ—Ä: https://abc123.ngrok.io)
# –î–æ–±–∞–≤—å—Ç–µ –≤ .env:
TELEGRAM_WEBHOOK_URL=https://abc123.ngrok.io/api/telegram/webhook

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ webhook
curl -X POST http://localhost:3000/api/telegram/set-webhook
```

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

```
/start - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
/help - –ü–æ–º–æ—â—å
/add_channel <URL> - –î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–∞–ª
/list_channels - –°–ø–∏—Å–æ–∫ –∫–∞–Ω–∞–ª–æ–≤
/remove_channel <ID> - –£–¥–∞–ª–∏—Ç—å –∫–∞–Ω–∞–ª
```

## Troubleshooting

**–ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç?**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
pm2 logs yt-combiner-backend

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook
curl http://localhost:3000/api/telegram/webhook-info
```

**"User not found"?**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω —Å–Ω–∞—á–∞–ª–∞ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å–∞–π—Ç–µ!

**Webhook –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è?**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ HTTPS
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑–≤–Ω–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

---

üìñ **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `TELEGRAM_BOT_SETUP.md`
